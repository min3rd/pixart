<div id="language-selector-container" class="flex items-center gap-0.5">
  <button
    type="button"
    id="lang-en-toggle"
    class="px-2 py-0.5 text-xs font-medium border border-r-0 rounded-l-sm transition-colors"
    [class.bg-blue-600]="isCurrentLang('en')"
    [class.text-white]="isCurrentLang('en')"
    [class.border-blue-600]="isCurrentLang('en')"
    [class.bg-neutral-100]="!isCurrentLang('en')"
    [class.dark:bg-neutral-700]="!isCurrentLang('en')"
    [class.text-neutral-700]="!isCurrentLang('en')"
    [class.dark:text-neutral-200]="!isCurrentLang('en')"
    [class.border-neutral-300]="!isCurrentLang('en')"
    [class.dark:border-neutral-600]="!isCurrentLang('en')"
    [class.hover:bg-neutral-200]="!isCurrentLang('en')"
    [class.dark:hover:bg-neutral-600]="!isCurrentLang('en')"
    (click)="selectLanguage('en')"
  >
    EN
  </button>

  <button
    type="button"
    id="lang-vi-toggle"
    class="px-2 py-0.5 text-xs font-medium border border-r-0 transition-colors"
    [class.bg-blue-600]="isCurrentLang('vi')"
    [class.text-white]="isCurrentLang('vi')"
    [class.border-blue-600]="isCurrentLang('vi')"
    [class.bg-neutral-100]="!isCurrentLang('vi')"
    [class.dark:bg-neutral-700]="!isCurrentLang('vi')"
    [class.text-neutral-700]="!isCurrentLang('vi')"
    [class.dark:text-neutral-200]="!isCurrentLang('vi')"
    [class.border-neutral-300]="!isCurrentLang('vi')"
    [class.dark:border-neutral-600]="!isCurrentLang('vi')"
    [class.hover:bg-neutral-200]="!isCurrentLang('vi')"
    [class.dark:hover:bg-neutral-600]="!isCurrentLang('vi')"
    (click)="selectLanguage('vi')"
  >
    VI
  </button>

  <button
    type="button"
    id="lang-dropdown-toggle"
    class="px-1 py-0.5 border rounded-r-sm transition-colors"
    [class.bg-blue-600]="!isCurrentLang('en') && !isCurrentLang('vi')"
    [class.text-white]="!isCurrentLang('en') && !isCurrentLang('vi')"
    [class.border-blue-600]="!isCurrentLang('en') && !isCurrentLang('vi')"
    [class.bg-neutral-100]="isCurrentLang('en') || isCurrentLang('vi')"
    [class.dark:bg-neutral-700]="isCurrentLang('en') || isCurrentLang('vi')"
    [class.text-neutral-700]="isCurrentLang('en') || isCurrentLang('vi')"
    [class.dark:text-neutral-200]="isCurrentLang('en') || isCurrentLang('vi')"
    [class.border-neutral-300]="isCurrentLang('en') || isCurrentLang('vi')"
    [class.dark:border-neutral-600]="isCurrentLang('en') || isCurrentLang('vi')"
    [class.hover:bg-neutral-200]="isCurrentLang('en') || isCurrentLang('vi')"
    [class.dark:hover:bg-neutral-600]="isCurrentLang('en') || isCurrentLang('vi')"
    [attr.aria-expanded]="isDropdownOpen()"
    [attr.aria-label]="'languageSelector.moreLanguages' | transloco"
    (click)="toggleDropdown()"
  >
    <ng-icon
      id="lang-dropdown-icon"
      name="heroChevronDown"
      class="w-3 h-3"
      [class.rotate-180]="isDropdownOpen()"
    ></ng-icon>
  </button>

  @if (isDropdownOpen()) {
    <div
      id="language-dropdown-menu"
      class="absolute top-full right-0 mt-1 py-1 w-36 bg-white dark:bg-neutral-800 border border-neutral-200 dark:border-neutral-700 rounded-sm shadow-lg z-50 max-h-64 overflow-y-auto"
      role="menu"
      [attr.aria-label]="'languageSelector.selectLanguage' | transloco"
    >
      @for (lang of availableLanguages; track lang.code) {
        <button
          type="button"
          [id]="'lang-option-' + lang.code"
          class="w-full px-3 py-1.5 text-left text-sm transition-colors flex items-center justify-between"
          [class.bg-blue-50]="isCurrentLang(lang.code)"
          [class.dark:bg-blue-900/30]="isCurrentLang(lang.code)"
          [class.text-blue-700]="isCurrentLang(lang.code)"
          [class.dark:text-blue-300]="isCurrentLang(lang.code)"
          [class.text-neutral-700]="!isCurrentLang(lang.code)"
          [class.dark:text-neutral-200]="!isCurrentLang(lang.code)"
          [class.hover:bg-neutral-100]="!isCurrentLang(lang.code)"
          [class.dark:hover:bg-neutral-700]="!isCurrentLang(lang.code)"
          role="menuitem"
          (click)="selectLanguage(lang.code)"
        >
          <span id="lang-option-name-{{ lang.code }}">{{ lang.name }}</span>
          @if (isCurrentLang(lang.code)) {
            <ng-icon
              id="lang-option-check-{{ lang.code }}"
              name="heroCheck"
              class="w-4 h-4"
            ></ng-icon>
          }
        </button>
      }
    </div>
  }
</div>
